generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Application {
  id               String   @id @default(auto()) @map("_id") @db.ObjectId

  applicantId      String   @unique
  applicant        String
  applicationDate  DateTime
  phoneNumber      String
  emailId          String
  sourceAt         String
  subject          String
  block            String
  attachment       String?               // "/uploads/xyz.pdf"

  // Status & officer
  concernedOfficer String?  @default("N/A")
  status           String   @default("Not Assigned Yet")

  // ----- TIMELINE – ARRAY OF OBJECTS -----
  timeline         TimelineEntry[]       // <-- MongoDB embedded array

  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  @@index([applicant])
  @@index([applicationDate])
  @@index([block])
  @@index([status])
  @@index([concernedOfficer])
}

model Admin {
  id           String   @id @default(auto()) @map("_id") @db.ObjectId
  adminId      String   @unique
  password     String
  role         String
  refreshToken String?   // ← ADD THIS LINE
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("AdminsDetails")
}

// Embedded document – stored **inside** the Application document
type TimelineEntry {
  section     String
  comment     String
  date        String    // "04/11/2025"
  pdfLink     String?
  department  String?
  officer     String?
}